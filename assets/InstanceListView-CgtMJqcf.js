import{q as s,R as q,k as R,j as N,c as A,l as O,x as u,z as o,F,A as G,B as S,v as p,u as v,m,E,C as k,_ as L,r as b,o as H,G as W}from"./index-Bxrtyfih.js";import{I as D,V as J}from"./VmListTable.vue_vue_type_style_index_0_scoped_0d5b3520_lang-CJl_cmLx.js";import{g as Q}from"./index-5KbyUD_j.js";function V(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?Object(arguments[t]):{},r=Object.keys(a);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(a).filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable}))),r.forEach(function(i){X(e,i,a[i])})}return e}function X(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var z=function(t,a){var r=V({},t,a.attrs);return s(D,V({},r,{icon:q}),null)};z.displayName="ReloadOutlined";z.inheritAttrs=!1;function Y(e){return new J({id:e.id.toString(),name:e.name,description:e.description,alias:e.alias,powerState:e.powerStatus,host:e.host,source:e.source,flavor:e.flavor})}function Z(e){return{RUNNING:"success",SHUTDOWN:"default",PAUSED:"warning",CRASHED:"error",NOSTATE:"default",SUSPENDED:"processing"}[e]||"default"}const K={class:"vm-list-table"},ee={key:1,class:"flavor-info"},te={class:"flavor-name"},ae={class:"flavor-description"},ne=R({__name:"VmListTable",props:{dataSource:{},loading:{type:Boolean,default:!1}},setup(e){const t=E(),{t:a}=N(),r=A(()=>[{title:a("message.vm.instance.table-header-id"),dataIndex:"id",key:"id",width:80,fixed:"left"},{title:a("message.vm.instance.table-header-name"),dataIndex:"name",key:"name",width:200},{title:a("message.vm.instance.table-header-description"),dataIndex:"description",key:"description",width:200},{title:a("message.vm.instance.table-header-alias"),dataIndex:"alias",key:"alias",width:150},{title:a("message.vm.instance.table-header-power-state"),dataIndex:"powerState",key:"powerState",width:120,align:"center"},{title:a("message.vm.instance.table-header-host"),dataIndex:"host",key:"host",width:150},{title:a("message.vm.instance.table-header-source"),dataIndex:"source",key:"source",width:150,customRender:({record:n})=>{var g;return((g=n.source)==null?void 0:g.name)||"-"}},{title:a("message.vm.instance.table-header-flavor"),dataIndex:"flavor",key:"flavor",width:200}]),i=n=>{t.push(`/servers/instances/${n.id}`)},_=n=>({onClick:()=>i(n),style:{cursor:"pointer"}});return(n,g)=>{const I=u("a-tag"),C=u("a-table");return k(),O("div",K,[s(C,{columns:r.value,"data-source":n.dataSource,loading:n.loading,pagination:!1,"row-key":f=>f.id,scroll:{x:1200},size:"middle","custom-row":_},{bodyCell:o(({column:f,record:l})=>{var w,y;return[f.key==="powerState"?(k(),F(I,{key:0,color:v(Z)(l.powerState)},{default:o(()=>[S(p(l.powerState),1)]),_:2},1032,["color"])):f.key==="flavor"?(k(),O("div",ee,[m("div",te,p((w=l.flavor)==null?void 0:w.name),1),m("div",ae,p((y=l.flavor)==null?void 0:y.description),1)])):G("",!0)]}),_:1},8,["columns","data-source","loading","row-key"])])}}}),se=L(ne,[["__scopeId","data-v-0d5b3520"]]),oe={class:"instance-list-view"},re={class:"page-title-section"},ie={class:"page-title"},ce={class:"page-subtitle"},le={class:"list-content-wrapper"},de={class:"table-container"},ue={class:"pagination-container"},me=R({__name:"InstanceListView",setup(e){const{t}=N(),a=E(),r=b([]),i=b(!1),_=b(1),n=b(10),g=b(0),I=b(0),C=A(()=>["10","20","50","100"]),f=(d,c)=>t("message.vm.instance.pagination-total",{start:c[0],end:c[1],total:d}),l=async()=>{try{i.value=!0;const d={page:_.value-1,size:n.value},h=await(await Q()).getInstanceList(d);r.value=h.data.map(Y),g.value=h.totalCount,I.value=h.totalPageCount}catch(d){console.error("Failed to load VM instances:",d),W.error(t("message.vm.instance.message-load-error"))}finally{i.value=!1}},w=d=>{_.value=d,l()},y=(d,c)=>{_.value=1,n.value=c,l()},T=()=>{l()},$=()=>{a.push("/servers/instances/create")};return H(()=>{l()}),(d,c)=>{const h=u("a-breadcrumb-item"),j=u("router-link"),B=u("a-breadcrumb"),P=u("a-button"),U=u("a-page-header"),M=u("a-pagination");return k(),O("div",oe,[s(U,{class:"instance-page-header"},{breadcrumb:o(()=>[s(B,null,{default:o(()=>[s(h,null,{default:o(()=>[S(p(v(t)("message.vm.instance.breadcrumb-server")),1)]),_:1}),s(h,null,{default:o(()=>[s(j,{to:"/servers/instances"},{default:o(()=>[S(p(v(t)("message.vm.instance.breadcrumb-instance")),1)]),_:1})]),_:1})]),_:1})]),title:o(()=>[m("div",re,[m("h1",ie,p(v(t)("message.vm.instance.page-title")),1),m("span",ce,p(v(t)("message.vm.instance.page-subtitle-count",{count:g.value})),1)])]),extra:o(()=>[s(P,{type:"text",size:"large",onClick:T},{default:o(()=>[s(v(z))]),_:1}),s(P,{type:"primary",size:"large",onClick:$},{default:o(()=>[S(p(v(t)("message.vm.instance.button-create")),1)]),_:1})]),_:1}),m("div",le,[m("div",de,[s(se,{"data-source":r.value,loading:i.value},null,8,["data-source","loading"]),m("div",ue,[s(M,{current:_.value,"onUpdate:current":c[0]||(c[0]=x=>_.value=x),"page-size":n.value,"onUpdate:pageSize":c[1]||(c[1]=x=>n.value=x),total:g.value,"show-size-changer":!0,"show-quick-jumper":!0,"show-total":f,"page-size-options":C.value,onChange:w,onShowSizeChange:y},null,8,["current","page-size","total","page-size-options"])])])])])}}}),ve=L(me,[["__scopeId","data-v-f38eb64d"]]);export{ve as default};
